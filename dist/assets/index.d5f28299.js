/* empty css                  */import{v as Qe}from"./el-loading.7e6d6370.js";import{E as Ye}from"./el-tree.5461fde7.js";import{E as Ze,a as Xe}from"./el-tag.de2594e3.js";import{E as ea,b as aa,d as oa}from"./el-input.68a624f5.js";import"./el-tooltip.89296c46.js";import{E as la}from"./el-icon.6cf20f75.js";import{E as sa,a as ta}from"./el-breadcrumb-item.113a55fd.js";import{E as na}from"./el-divider.7569b926.js";import{E as ra}from"./el-link.a774dbff.js";import{b as da,q as ia,d as ve,u as ca,o as f,g as m,n as M,a as z,j as me,h as w,C as t,D as ua,_ as pa,k as i,t as _,p as fa,Y as ma,r,aA as A,Z as ha,cp as va,$ as X,F as _a,W as ga,aE as ya,S as wa,M as o,w as l,aC as x,aG as Ca,aF as ba,aD as p,cc as ka,am as Sa,bR as Ea,al as he,aB as ee,V as v,cn as Fa,cq as Da,cr as Ta,cb as Ia,f as Va}from"./index.b1ab2185.js";import{s as k}from"./index.7ca08e25.js";import"./index.1ca9696f.js";import"./debounce.0bdc5006.js";const xa=da({header:{type:String,default:""},bodyStyle:{type:ia([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),Pa=ve({name:"ElCard"}),Ua=ve({...Pa,props:xa,setup(_e){const C=ca("card");return(c,K)=>(f(),m("div",{class:M([z(C).b(),z(C).is(`${c.shadow}-shadow`)])},[c.$slots.header||c.header?(f(),m("div",{key:0,class:M(z(C).e("header"))},[me(c.$slots,"header",{},()=>[i(_(c.header),1)])],2)):w("v-if",!0),t("div",{class:M([z(C).e("body"),c.bodyClass]),style:ua(c.bodyStyle)},[me(c.$slots,"default")],6)],2))}});var Ra=pa(Ua,[["__file","/home/runner/work/element-plus/element-plus/packages/components/card/src/card.vue"]]);const La=fa(Ra);const Na={"element-loading-text":"Loading...",class:"pan-share-content"},Oa={class:"pan-share-header-content"},Ba={class:"pan-share-header-content-wrapper"},$a={key:0,class:"pan-share-header-user-info-content"},za={key:1,class:"pan-share-header-button-content"},Aa={class:"pan-share-list-content"},Ma={class:"pan-share-list-wrapper"},Ka={key:0,slot:"header",class:"pan-share-list-card-header"},Wa={class:"pan-share-list-card-header-share-info-content"},Ha={class:"pan-share-list-card-header-share-info"},ja={class:"pan-share-list-card-header-time"},qa={class:"pan-share-list-card-header-create-date"},Ja=t("i",{class:"fa fa-clock-o"},null,-1),Ga={class:"pan-share-list-card-header-expire-date"},Qa=t("i",{class:"fa fa-clock-o"},null,-1),Ya={class:"pan-share-list-card-button-group"},Za={key:1,class:"pan-share-list-card-error-message"},Xa=t("span",null,"Sorry, the share has expired or has been cancelled",-1),eo=[Xa],ao={key:2,class:"pan-share-list-card-operate-content"},oo={class:"pan-share-list-card-operate-bread-crumb"},lo=["onClick"],so={key:3,class:"pan-share-list"},to=["onClick"],no={style:{cursor:"pointer"}},ro={class:"file-operation-content"},io={class:"dialog-footer"},co={class:"pan-share-code-content"},uo={class:"pan-share-code-wrapper"},po={class:"tree-content"},fo={class:"custom-tree-node"},mo={class:"dialog-footer"},Po={__name:"index",setup(_e){const C=ma(),c=r(null),K=r(null),W=r(null),ge=r(null),ae=r(null),oe=r(null),ye=()=>{ae.value.focus()},we=()=>{c.value.resetFields()},Ce=()=>{oe.value.focus()},be=()=>{W.value.resetFields()},ke=A({username:[{validator:(e,a,s)=>{if(!v.checkUsername(a)){s("Please enter username, 6-16 digits, numbers/letters only");return}s()},trigger:"blur"}],password:[{validator:(e,a,s)=>{if(!v.checkPassword(a)){s("Please enter password, 8-16 digits");return}s()},trigger:"blur"}]}),Se=A({shareCode:[{required:!0,message:"Please enter share code",trigger:"blur"}]}),g=A({username:"",password:""}),u=r(!1),P=r(""),S=r(!1),E=r(!1),F=r(!1),U=A({shareCode:""}),R=r(""),D=r(!1),H=r([]),Ee=r(window.innerHeight-300),h=r([]),le=r(!0),se=r(""),j=r(""),T=r([{id:"-1",name:"All"}]),q=r([]),b=r(!1),L=r(void 0),Fe=e=>{let a=e.shareUserInfoVO.username,s=e.shareName;R.value="Share: "+s+", from "+a,se.value=e.createTime,e.shareDay===0?j.value="Permanent":j.value=e.shareEndTime,H.value=e.rpanUserFileVOList},J=()=>C.params.shareId,te=()=>{D.value=!0},De=()=>{k.getSimpleShareDetail({shareId:J()},e=>{e.code===0?(F.value=!0,R.value="Share: "+e.data.shareName+", from: "+e.data.shareUserInfoVO.username):(F.value=!1,te())})},G=()=>{k.getShareDetail(e=>{e.code===0?Fe(e.data):e.code===4?De():te()})},N=()=>{x.infoWithoutPageJump(e=>{e.code===0?(P.value=e.data.username,E.value=!0):(P.value="",E.value=!1)})},O=()=>{S.value=!0},Te=()=>{Ca.confirm("Logout?","Reminder",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}).then(()=>{x.exit(()=>{ba(),E.value=!1,P.value=""},e=>{p.error(e.message)})})},Q=async()=>{await c.value.validate((e,a)=>{e&&(u.value=!0,x.login({username:g.username,password:g.password},s=>{u.value=!1,Fa(s.data),S.value=!1,N()},s=>{u.value=!1,p.error(s.message)}))})},Ie=()=>{window.location.href="/"},ne=async()=>{await W.value.validate(e=>{e&&(u.value=!0,k.checkShareCode({shareId:J(),shareCode:U.shareCode},a=>{a.code===0?(u.value=!1,Da(a.data),F.value=!1,G()):(u.value=!1,p.error(a.message))}))})},Ve=e=>{h.value=e},xe=(e,a,s,y)=>{v.showOperation(s)},Pe=(e,a,s,y)=>{v.hiddenOperation(s)},Ue=e=>{e.folderFlag===1&&Re(e)},Re=e=>{T.value.push({id:e.fileId,name:e.filename}),re(e.fileId)},re=e=>{k.getShareFiles({parentId:e},a=>{a.code===0?H.value=a.data:window.location.reload()})},Le=e=>{if(e==="-1")T.value=[{id:"-1",name:"All"}],G();else{let a=new Array;T.value.some(s=>{if(a.push(s),s.id===e)return!0}),T.value=a,re(e)}},Ne=()=>{if(!h.value||h.value.length===0){p.error("Please select the files you want to download");return}for(let e=0,a=h.value.length;e<a;e++)if(h.value[e].folderFlag===1){p.error("Folder cannot be downloaded");return}de(h.value)},de=(e,a)=>{a||(a=0),e.length!==a&&setTimeout(function(){ie(e[a]),a++,de(e,a)},500)},ie=e=>{if(e.folderFlag===1){p.error("Folder cannot be downloaded");return}x.infoWithoutPageJump(a=>{a.code===0?k.getSimpleShareDetail({shareId:J()},s=>{if(s.code===0){let y=v.getUrlPrefix()+"/share/file/download?fileId="+v.handleId(e.fileId)+"&shareToken="+Ta()+"&authorization="+Ia(),I=e.filename,d=document.createElement("a");d.style.display="none",d.href=y,d.setAttribute("download",I),document.body.appendChild(d),d.click(),document.body.removeChild(d)}else window.location.reload()}):(N(),O())})},Oe=()=>{q.value=new Array,L.value=void 0},Be=()=>{ka.getFolderTree(e=>{q.value=e.data},e=>{p.error(e.message)})},$e=()=>{u.value=!0;let e=K.value.getCurrentNode();if(!e){p.error("Please select the target folder"),u.value=!1;return}ze(e.id)},ce=e=>{if(e)L.value=e;else if(!h.value||h.value.length===0){p.error("Please select the files you want to save");return}x.infoWithoutPageJump(a=>{a.code===0?b.value=!0:O()})},ze=e=>{let a="";if(L.value)a=L.value.fileId;else{let s=new Array;h.value.forEach(y=>{s.push(y.fileId)}),a=s.join(v.COMMON_SEPARATOR)}k.saveShareFiles({fileIds:a,targetParentId:e},s=>{s.code===0?(p.success("Save success"),b.value=!1):s.code===10?(b.value=!1,N(),O()):p.error(s.message),u.value=!1})},Ae=e=>v.getFileFontElement(e);return ha(()=>{va(),G(),N(),le.value=!1}),(e,a)=>{const s=ra,y=X("DocumentCopy"),I=_a,d=ga,Me=X("Download"),Ke=na,We=sa,He=ta,B=Ze,ue=la,je=Xe,pe=La,Y=ya,$=ea,fe=aa,Z=oa,qe=X("Folder"),Je=Ye,Ge=Qe;return wa((f(),m("div",Na,[t("div",Oa,[t("div",Ba,[t("div",{class:"pan-share-header-title-font-content"},[t("span",{class:"pan-share-header-title-font",onClick:Ie},"Drive Harbor")]),E.value?(f(),m("div",$a,[o(s,{underline:!1,type:"success",class:"pan-share-username"},{default:l(()=>[i(" Welcome, "+_(P.value),1)]),_:1}),o(s,{underline:!1,type:"success",class:"pan-share-exit-button",onClick:Te},{default:l(()=>[i(" Quit ")]),_:1})])):w("",!0),E.value?w("",!0):(f(),m("div",za,[o(s,{underline:!1,type:"primary",class:"pan-share-login-button",onClick:O},{default:l(()=>[i(" Login ")]),_:1}),o(s,{underline:!1,type:"primary",class:"pan-share-register-button",href:"/register",target:"_blank"},{default:l(()=>[i(" Signup ")]),_:1})]))])]),t("div",Aa,[t("div",Ma,[o(pe,{shadow:"always",class:"pan-share-list-card"},{default:l(()=>[D.value?w("",!0):(f(),m("div",Ka,[t("div",Wa,[t("span",Ha,_(R.value),1),t("div",ja,[t("span",qa,[Ja,i("Share time: "+_(se.value),1)]),t("span",Ga,[Qa,i("Expiration time: "+_(j.value),1)])])]),t("div",Ya,[o(d,{type:"success",size:"default",round:"",onClick:a[0]||(a[0]=n=>ce(void 0))},{default:l(()=>[i("Save to my drive "),o(I,{class:"el-icon--right"},{default:l(()=>[o(y)]),_:1})]),_:1}),o(d,{type:"info",size:"default",round:"",onClick:Ne},{default:l(()=>[i("Download "),o(I,{class:"el-icon--right"},{default:l(()=>[o(Me)]),_:1})]),_:1})]),o(Ke)])),D.value?(f(),m("div",Za,eo)):w("",!0),D.value?w("",!0):(f(),m("div",ao,[t("div",oo,[o(He,{"separator-class":"el-icon-arrow-right"},{default:l(()=>[(f(!0),m(Sa,null,Ea(T.value,(n,V)=>(f(),Va(We,{key:V},{default:l(()=>[t("a",{class:"breadcrumb-item-a",onClick:_o=>Le(n.id),href:"#"},_(n.name),9,lo)]),_:2},1024))),128))]),_:1})])])),D.value?w("",!0):(f(),m("div",so,[o(je,{ref_key:"fileTableRef",ref:ge,data:H.value,height:Ee.value,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:Ve,onCellMouseEnter:xe,onCellMouseLeave:Pe},{default:l(()=>[o(B,{type:"selection",width:"55"}),o(B,{label:"File Name",prop:"filename",sortable:"","show-overflow-tooltip":"","min-width":"750"},{default:l(n=>[t("div",{onClick:V=>Ue(n.row),class:"file-name-content"},[t("i",{class:M(Ae(n.row.fileType)),style:{"margin-right":"15px","font-size":"20px",cursor:"pointer"}},null,2),t("span",no,_(n.row.filename),1)],8,to),t("div",ro,[o(ue,{class:"item",effect:"light",content:"Save to my drive",placement:"top"},{default:l(()=>[o(d,{type:"success",icon:"DocumentCopy",size:"small",circle:"",onClick:V=>ce(n.row)},null,8,["onClick"])]),_:2},1024),o(ue,{class:"item",effect:"light",content:"Download",placement:"top"},{default:l(()=>[o(d,{type:"info",icon:"Download",size:"small",circle:"",onClick:V=>ie(n.row)},null,8,["onClick"])]),_:2},1024)])]),_:1}),o(B,{prop:"fileSizeDesc",sortable:"",label:"Size","min-width":"120",align:"center"}),o(B,{prop:"updateTime",sortable:"",align:"center",label:"Update Time","min-width":"240"})]),_:1},8,["data","height"])]))]),_:1})])]),o(Z,{title:"Welcome!",modelValue:S.value,"onUpdate:modelValue":a[5]||(a[5]=n=>S.value=n),onOpened:ye,onClosed:we,width:"30%","append-to-body":"","modal-append-to-body":!1,center:""},{footer:l(()=>[t("span",io,[o(d,{onClick:a[4]||(a[4]=n=>S.value=!1)},{default:l(()=>[i("Cancel")]),_:1}),o(d,{type:"primary",onClick:Q,loading:u.value},{default:l(()=>[i("Confirm")]),_:1},8,["loading"])])]),default:l(()=>[t("div",null,[o(fe,{"label-width":"100px",rules:ke,ref_key:"loginFormRef",ref:c,model:g,"status-icon":"",onSubmit:a[3]||(a[3]=he(()=>{},["prevent"]))},{default:l(()=>[o($,{label:"Username",prop:"username"},{default:l(()=>[o(Y,{type:"text",ref_key:"usernameEl",ref:ae,onKeyup:ee(Q,["enter","native"]),modelValue:g.username,"onUpdate:modelValue":a[1]||(a[1]=n=>g.username=n),autocomplete:"off"},null,8,["onKeyup","modelValue"])]),_:1}),o($,{label:"Password",prop:"password"},{default:l(()=>[o(Y,{type:"password","show-password":"",onKeyup:ee(Q,["enter","native"]),modelValue:g.password,"onUpdate:modelValue":a[2]||(a[2]=n=>g.password=n),autocomplete:"off"},null,8,["onKeyup","modelValue"])]),_:1})]),_:1},8,["rules","model"])])]),_:1},8,["modelValue"]),o(Z,{modelValue:F.value,"onUpdate:modelValue":a[8]||(a[8]=n=>F.value=n),onOpened:Ce,onClosed:be,width:"30%",fullscreen:"","append-to-body":"","modal-append-to-body":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{default:l(()=>[t("div",co,[t("div",uo,[o(pe,{header:R.value,shadow:"always",class:"pan-share-code-card"},{default:l(()=>[o(fe,{class:"pan-share-code-form",inline:"",rules:Se,ref_key:"shareCodeFormRef",ref:W,model:U,onSubmit:a[7]||(a[7]=he(()=>{},["prevent"]))},{default:l(()=>[o($,{label:"Code",prop:"shareCode"},{default:l(()=>[o(Y,{type:"text",ref_key:"shareCodeEl",ref:oe,onKeyup:ee(ne,["enter","native"]),modelValue:U.shareCode,"onUpdate:modelValue":a[6]||(a[6]=n=>U.shareCode=n),autocomplete:"off"},null,8,["onKeyup","modelValue"])]),_:1}),o($,null,{default:l(()=>[o(d,{type:"primary",loading:u.value,onClick:ne},{default:l(()=>[i("Confirm")]),_:1},8,["loading"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["header"])])])]),_:1},8,["modelValue"]),o(Z,{title:"Save to my drive",modelValue:b.value,"onUpdate:modelValue":a[10]||(a[10]=n=>b.value=n),onOpen:Be,onClosed:Oe,width:"30%","append-to-body":"","modal-append-to-body":!1,center:""},{footer:l(()=>[t("span",mo,[o(d,{onClick:a[9]||(a[9]=n=>b.value=!1)},{default:l(()=>[i("Cancel")]),_:1}),o(d,{type:"primary",onClick:$e,loading:u.value},{default:l(()=>[i("Confirm")]),_:1},8,["loading"])])]),default:l(()=>[t("div",po,[o(Je,{data:q.value,class:"tree","empty-text":"No data available","default-expand-all":"","highlight-current":"","check-on-click-node":"","expand-on-click-node":!1,ref_key:"treeRef",ref:K},{default:l(({node:n,data:V})=>[t("span",fo,[o(I,{size:20,style:{"margin-right":"15px",cursor:"pointer"}},{default:l(()=>[o(qe)]),_:1}),t("span",null,_(n.label),1)])]),_:1},8,["data"])])]),_:1},8,["modelValue"])])),[[Ge,le.value]])}}};export{Po as default};
